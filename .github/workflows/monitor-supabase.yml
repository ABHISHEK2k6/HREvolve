name: Monitor Supabase Status

on:
  schedule:
    # Check daily at 9 AM UTC
    - cron: '0 9 * * *'
  workflow_dispatch:

jobs:
  check-supabase:
    runs-on: ubuntu-latest
    
    steps:
    - name: Check Supabase Status
      env:
        NEXT_PUBLIC_SUPABASE_URL: ${{ secrets.NEXT_PUBLIC_SUPABASE_URL }}
        NEXT_PUBLIC_SUPABASE_ANON_KEY: ${{ secrets.NEXT_PUBLIC_SUPABASE_ANON_KEY }}
      run: |
        # Test database connectivity
        response=$(curl -s -w "%{http_code}" -o /dev/null "$NEXT_PUBLIC_SUPABASE_URL/rest/v1/" \
          -H "apikey: $NEXT_PUBLIC_SUPABASE_ANON_KEY")
        
        if [ "$response" -eq 200 ]; then
          echo "✅ Supabase is active and healthy"
        else
          echo "❌ Supabase may be paused or having issues (HTTP: $response)"
          # You could add notification logic here (Slack, email, etc.)
        fi